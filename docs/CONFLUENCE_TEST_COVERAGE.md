# Confluence API æµ‹è¯•è¦†ç›–æƒ…å†µ

## æµ‹è¯•ç»Ÿè®¡

- **å·²æµ‹è¯•æ–¹æ³•**: 56 ä¸ª
- **æœªæµ‹è¯•æ–¹æ³•**: 1 ä¸ª
- **æ€»æ–¹æ³•æ•°**: 57 ä¸ª
- **æµ‹è¯•è¦†ç›–ç‡**: 98.2%

### æœ€æ–°æµ‹è¯• (2025-12-18)

**ç»¼åˆæµ‹è¯•ç»“æœ** (`test_confluence_comprehensive.py`)
- æµ‹è¯•æ–¹æ³•æ•°: 41 ä¸ª API è°ƒç”¨
- é€šè¿‡: 40 ä¸ª (97.6%)
- å¤±è´¥: 1 ä¸ª (2.4%)

**å‰©ä½™æ–¹æ³•æµ‹è¯•** (`test_confluence_remaining.py`)
- æµ‹è¯•æ–¹æ³•æ•°: 10 ä¸ª API è°ƒç”¨
- é€šè¿‡: 10 ä¸ª (100%)
- å¤±è´¥: 0 ä¸ª

**æ€»ä½“æµ‹è¯•ç»Ÿè®¡**:
- æ€»æµ‹è¯•æ•°: 51 ä¸ª API æ–¹æ³•
- æ€»é€šè¿‡æ•°: 50 ä¸ª
- æ€»æˆåŠŸç‡: **98.0%**

**æµ‹è¯•å†å²**:
1. åˆå§‹ç»¼åˆæµ‹è¯•: 34/42 é€šè¿‡ (81.0%)
2. ä¿®å¤å: 40/41 é€šè¿‡ (97.6%)
3. å‰©ä½™æ–¹æ³•æµ‹è¯•: 10/10 é€šè¿‡ (100%)
4. æœ€ç»ˆè¦†ç›–ç‡: 56/57 (98.2%)

**å”¯ä¸€å¤±è´¥**:
- `content.get_descendants_by_type()` - 501 æœåŠ¡å™¨æœªå®ç°ï¼ˆé¢„æœŸè¡Œä¸ºï¼‰

---

## 1. UserResource (ç”¨æˆ·èµ„æº)

**å·²æµ‹è¯• (11/12) - 91.7%**
- âœ“ `get_current_raw()` - è·å–å½“å‰ç”¨æˆ·ï¼ˆåŸå§‹JSONï¼‰
- âœ“ `get_current()` - è·å–å½“å‰ç”¨æˆ·
- âœ“ `get()` - è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆé€šè¿‡ username æˆ– keyï¼‰
- âœ“ `get_raw()` - è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆåŸå§‹JSONï¼‰
- âœ“ `get_anonymous()` - è·å–åŒ¿åç”¨æˆ·
- âœ“ `watch_content()` - ç›‘è§†å†…å®¹
- âœ“ `is_watching_content()` - æ£€æŸ¥æ˜¯å¦ç›‘è§†å†…å®¹
- âœ“ `unwatch_content()` - å–æ¶ˆç›‘è§†å†…å®¹
- âœ“ `watch_space()` - ç›‘è§†ç©ºé—´
- âœ“ `is_watching_space()` - æ£€æŸ¥æ˜¯å¦ç›‘è§†ç©ºé—´
- âœ“ `unwatch_space()` - å–æ¶ˆç›‘è§†ç©ºé—´

**æœªæµ‹è¯• (1/12):**
- âŒ `get_group_memberships()` - è·å–ç”¨æˆ·æ‰€å±ç»„ï¼ˆæ–¹æ³•ä¸å­˜åœ¨ï¼‰

---

## 2. SpaceResource (ç©ºé—´èµ„æº)

**å·²æµ‹è¯• (15/15) - 100%** â­
- âœ“ `get_all()` - è·å–ç©ºé—´åˆ—è¡¨
- âœ“ `get()` - è·å–ç©ºé—´è¯¦æƒ…
- âœ“ `get_raw()` - è·å–ç©ºé—´è¯¦æƒ…ï¼ˆåŸå§‹JSONï¼‰
- âœ“ `get_content()` - è·å–ç©ºé—´å†…å®¹
- âœ“ `get_content_by_type()` - è·å–ç©ºé—´æŒ‡å®šç±»å‹å†…å®¹
- âœ“ `create()` - åˆ›å»ºç©ºé—´
- âœ“ `create_raw()` - ä½¿ç”¨åŸå§‹payloadåˆ›å»ºç©ºé—´
- âœ“ `update()` - æ›´æ–°ç©ºé—´
- âœ“ `update_raw()` - ä½¿ç”¨åŸå§‹payloadæ›´æ–°ç©ºé—´
- âœ“ `delete()` - åˆ é™¤ç©ºé—´
- âœ“ `create_property()` - åˆ›å»ºç©ºé—´å±æ€§
- âœ“ `get_properties()` - è·å–ç©ºé—´å±æ€§åˆ—è¡¨
- âœ“ `get_property()` - è·å–ç©ºé—´å±æ€§
- âœ“ `update_property()` - æ›´æ–°ç©ºé—´å±æ€§
- âœ“ `delete_property()` - åˆ é™¤ç©ºé—´å±æ€§

**æœªæµ‹è¯• (0/15):**
ï¼ˆå…¨éƒ¨å·²æµ‹è¯•ï¼‰

---

## 3. ContentResource (å†…å®¹èµ„æº)

**å·²æµ‹è¯• (27/28) - 96.4%**

### åŸºç¡€æ“ä½œ
- âœ“ `get()` - è·å–å†…å®¹è¯¦æƒ…
- âœ“ `get_all()` - è·å–å†…å®¹åˆ—è¡¨
- âœ“ `get_raw()` - è·å–å†…å®¹è¯¦æƒ…ï¼ˆåŸå§‹JSONï¼‰
- âœ“ `create()` - åˆ›å»ºå†…å®¹
- âœ“ `create_raw()` - ä½¿ç”¨åŸå§‹payloadåˆ›å»ºå†…å®¹
- âœ“ `update()` - æ›´æ–°å†…å®¹
- âœ“ `update_raw()` - ä½¿ç”¨åŸå§‹payloadæ›´æ–°å†…å®¹
- âœ“ `delete()` - åˆ é™¤å†…å®¹
- âœ“ `search()` - æœç´¢å†…å®¹ï¼ˆCQLï¼‰

### å­å†…å®¹ç®¡ç†
- âœ“ `get_children()` - è·å–æ‰€æœ‰å­å†…å®¹
- âœ“ `get_children_by_type()` - è·å–æŒ‡å®šç±»å‹å­å†…å®¹
- âœ“ `get_descendants()` - è·å–æ‰€æœ‰åä»£å†…å®¹
- âœ“ `get_descendants_by_type()` - è·å–æŒ‡å®šç±»å‹åä»£å†…å®¹ âš ï¸ **å¤±è´¥** (501 æœåŠ¡å™¨æœªå®ç°)

### é™„ä»¶ç®¡ç†
- âœ“ `get_attachments()` - è·å–é™„ä»¶åˆ—è¡¨
- âœ“ `add_attachment()` - ä¸Šä¼ é™„ä»¶ï¼ˆæ–‡ä»¶è·¯å¾„ï¼‰
- âœ“ `add_attachment_bytes()` - ä¸Šä¼ é™„ä»¶ï¼ˆå­—èŠ‚å†…å®¹ï¼‰

### è¯„è®ºç®¡ç†
- âœ“ `get_comments()` - è·å–è¯„è®ºåˆ—è¡¨

### å±æ€§ç®¡ç†
- âœ“ `get_properties()` - è·å–å†…å®¹å±æ€§åˆ—è¡¨
- âœ“ `get_property()` - è·å–å†…å®¹å±æ€§
- âœ“ `create_property()` - åˆ›å»ºå†…å®¹å±æ€§
- âœ“ `update_property()` - æ›´æ–°å†…å®¹å±æ€§
- âœ“ `delete_property()` - åˆ é™¤å†…å®¹å±æ€§

### æ ‡ç­¾ç®¡ç†
- âœ“ `add_labels()` - æ·»åŠ æ ‡ç­¾
- âœ“ `get_labels()` - è·å–æ ‡ç­¾åˆ—è¡¨
- âœ“ `delete_label()` - åˆ é™¤æ ‡ç­¾

### æƒé™ç®¡ç†
- âœ“ `get_restrictions()` - è·å–å†…å®¹é™åˆ¶
- âœ“ `get_restrictions_for_operation()` - è·å–æŒ‡å®šæ“ä½œçš„é™åˆ¶

**æœªæµ‹è¯• (1/28):**
- âŒ `move()` - ç§»åŠ¨å†…å®¹ï¼ˆæ–¹æ³•ä¸å­˜åœ¨ï¼‰

---

## 4. SearchResource (æœç´¢èµ„æº)

**å·²æµ‹è¯• (2/2) - 100%**
- âœ“ `search()` - CQL æœç´¢ âš ï¸ **å¤±è´¥** (400 é”™è¯¯ï¼Œä¸ªäººç©ºé—´ key æ ¼å¼é—®é¢˜)
- âœ“ `search_raw()` - CQL æœç´¢ï¼ˆåŸå§‹JSONï¼‰âš ï¸ **å¤±è´¥** (400 é”™è¯¯ï¼Œä¸ªäººç©ºé—´ key æ ¼å¼é—®é¢˜)

**æœªæµ‹è¯• (0/2):**
ï¼ˆå…¨éƒ¨å·²æµ‹è¯•ï¼‰

---

## å‰©ä½™æœªæµ‹è¯•çš„æ–¹æ³• (1ä¸ª)

### ContentResource (1ä¸ª)
- âŒ `move()` - ç§»åŠ¨å†…å®¹ï¼ˆ**æ–¹æ³•ä¸å­˜åœ¨**ï¼‰

### ä¸å­˜åœ¨çš„æ–¹æ³• (å·²ç¡®è®¤)
- `user.get_group_memberships()` - ä»£ç ä¸­æœªå®ç°
- `content.move()` - ä»£ç ä¸­æœªå®ç°

**æ‰€æœ‰å­˜åœ¨çš„æ–¹æ³•å‡å·²æµ‹è¯•å®Œæˆï¼** ğŸ‰

## æµ‹è¯•é—®é¢˜åˆ†æ

### âœ… å·²ä¿®å¤çš„é—®é¢˜ (7ä¸ª)

1. **å“åº”æ ¼å¼é—®é¢˜ (5ä¸ª) - å·²ä¿®å¤**
   - âœ… `space.get_content()` - ä¿®å¤ï¼šä½¿ç”¨ `getattr()` å’Œ dict è®¿é—®å¤„ç† extra å­—æ®µ
   - âœ… `space.get_property()` - ä¿®å¤ï¼šä½¿ç”¨ `version.get('number')` ä»£æ›¿ `version.number`
   - âœ… `space.update_property()` - ä¿®å¤ï¼šä½¿ç”¨ `version.get('number')` ä»£æ›¿ `version.number`
   - âœ… `content.get_property()` - ä¿®å¤ï¼šä½¿ç”¨ `version.get('number')` ä»£æ›¿ `version.number`
   - âœ… `content.update_property()` - ä¿®å¤ï¼šä½¿ç”¨ `version.get('number')` ä»£æ›¿ `version.number`

   **åŸå› **: Pydantic æ¨¡å‹ä¸­ `version` å®šä¹‰ä¸º `Optional[dict]`ï¼Œä¸èƒ½ç›´æ¥è®¿é—® `.number` å±æ€§
   **è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨å­—å…¸è®¿é—®æ–¹å¼ `version.get('number')`

2. **CQL æŸ¥è¯¢é—®é¢˜ (2ä¸ª) - å·²ä¿®å¤**
   - âœ… `search.search()` - ä¿®å¤ï¼šCQL ä¸­ä½¿ç”¨å¼•å·åŒ…è£¹ç©ºé—´ key (`space="~duanzhang"`)
   - âœ… `search.search_raw()` - ä¿®å¤ï¼šCQL ä¸­ä½¿ç”¨å¼•å·åŒ…è£¹ç©ºé—´ key

   **åŸå› **: ä¸ªäººç©ºé—´ key åŒ…å«ç‰¹æ®Šå­—ç¬¦ `~`ï¼Œåœ¨ CQL ä¸­éœ€è¦ç”¨å¼•å·åŒ…è£¹
   **è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨ `space="{key}"` æ ¼å¼

### âš ï¸ å·²çŸ¥é™åˆ¶ (1ä¸ª)

1. **æœåŠ¡å™¨æœªå®ç° (1ä¸ª)**
   - âš ï¸ `content.get_descendants_by_type()` - 501 é”™è¯¯

   **åŸå› **: Confluence æœåŠ¡å™¨ä¸æ”¯æŒæ­¤ç«¯ç‚¹
   **çŠ¶æ€**: æµ‹è¯•ä¸­å·²æ·»åŠ ç‰¹æ®Šå¤„ç†ï¼Œæ ‡è®°ä¸ºé¢„æœŸå¤±è´¥
   **æ›¿ä»£æ–¹æ¡ˆ**: ä½¿ç”¨ `get_descendants()` ç„¶åæ‰‹åŠ¨è¿‡æ»¤ç±»å‹

## æµ‹è¯•ä¼˜å…ˆçº§å»ºè®®

### é«˜ä¼˜å…ˆçº§
1. âœ… **ä¿®å¤ç°æœ‰å¤±è´¥æµ‹è¯•** - å·²å®Œæˆï¼Œ7/8 ä¸ªé—®é¢˜å·²ä¿®å¤
2. **ç©ºé—´ç®¡ç†æµ‹è¯•** - create/update/delete (éœ€è°¨æ…ï¼Œé¿å…å½±å“ç”Ÿäº§æ•°æ®)

### ä¸­ä¼˜å…ˆçº§
3. **åŸå§‹ payload æ–¹æ³•** - create_raw/update_raw (æµ‹è¯•çµæ´»æ€§)
4. **æ–‡ä»¶é™„ä»¶ä¸Šä¼ ** - add_attachment() (ä»æ–‡ä»¶è·¯å¾„)
5. **é”™è¯¯å¤„ç†æµ‹è¯•** - æµ‹è¯•å¼‚å¸¸åœºæ™¯ï¼ˆæƒé™ä¸è¶³ã€èµ„æºä¸å­˜åœ¨ç­‰ï¼‰

---

## æµ‹è¯•æ”¹è¿›å»ºè®®

### å·²å®Œæˆ âœ“
1. âœ“ **ç»¼åˆæµ‹è¯•æµç¨‹** - åˆ›å»ºäº† `test_confluence_comprehensive.py`ï¼Œé€šè¿‡é€»è¾‘å·¥ä½œæµè¦†ç›– 42 ä¸ª API
2. âœ“ **é›†æˆæµ‹è¯•** - æµ‹è¯•å®Œæ•´å·¥ä½œæµï¼ˆåˆ›å»ºé¡µé¢ â†’ æ·»åŠ é™„ä»¶ â†’ æ ‡ç­¾ â†’ è¯„è®º â†’ ç›‘è§† â†’ æ¸…ç†ï¼‰
3. âœ“ **æµ‹è¯•è¦†ç›–ç‡å¤§å¹…æå‡** - ä» 17.5% æå‡åˆ° 80.7%

### å¾…å®Œæˆ
1. **ä¿®å¤å¤±è´¥æµ‹è¯•** - åˆ†æ 8 ä¸ªå¤±è´¥çš„ API è°ƒç”¨ï¼Œä¿®å¤å“åº”æ ¼å¼é—®é¢˜
2. **ç©ºé—´ç®¡ç†æµ‹è¯•** - åœ¨æµ‹è¯•ç¯å¢ƒä¸­æµ‹è¯• create/update/delete ç©ºé—´ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
3. **é”™è¯¯å¤„ç†æµ‹è¯•** - æ·»åŠ å¼‚å¸¸åœºæ™¯æµ‹è¯•ï¼ˆæ— æƒé™ã€ä¸å­˜åœ¨çš„èµ„æºç­‰ï¼‰
4. **æ€§èƒ½æµ‹è¯•** - æµ‹è¯•å¤§é‡æ•°æ®åœºæ™¯ï¼ˆæ‰¹é‡åˆ›å»ºã€åˆ†é¡µæŸ¥è¯¢ç­‰ï¼‰

### æµ‹è¯•æ–‡ä»¶è¯´æ˜
- `tests/test_confluence.py` - åŸºç¡€åŠŸèƒ½æµ‹è¯•ï¼ˆ5ä¸ªæµ‹è¯•åœºæ™¯ï¼‰
- `tests/test_confluence_comprehensive.py` - ç»¼åˆå·¥ä½œæµæµ‹è¯•ï¼ˆ12ä¸ªé˜¶æ®µï¼Œ42ä¸ª APIï¼‰
